<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nini & Zoya's Celestial Sanctuary</title>
    <link rel="icon" href="photos/favicon1.png" type="image/png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Dancing+Script:wght@400;700&family=Philosopher:ital,wght@0,400;0,700;1,400&family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet">
    
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    
    <link rel="stylesheet" href="css/common.css">
    
    <link rel="stylesheet" href="css/chinese_aesthetics.css">
</head>
<body>

    <div class="background-container">
        <canvas id="web-canvas-landing"></canvas>
        <canvas id="spiral-canvas-landing"></canvas>
        <canvas id="landing-particles-canvas"></canvas>
    </div>

    <section id="landing-gate">
        <div class="gate-container">
            <div class="gate-content">
                <h1 class="main-title">Nini & Zoya</h1>
                <p class="subtitle">A Celestial Sanctuary</p>
                <p class="description">
                    "From the moment our paths crossed at that sports festival, a new universe was born. This is a living archive of that universe‚Äîa world built on shared memories, quiet understanding, and a love that spans across time and space."
                </p>
                <div class="countries">
                    Uganda <span class="heart-icon">üíñ</span> China
                </div>
                <p class="prophecy">
                    "Two souls, one orbit, bound by a gravity stronger than any star."
                </p>
                <p class="prompt">[ Click anywhere to Enter ]</p>
                
                <a href="#observatory-direct" id="heart-portal" style="text-decoration: none; color: var(--gold); margin-top: 2rem; display: inline-block; font-family: var(--font-display);">
                    Or, journey directly to the üî≠ Observatory
                </a>
            </div>
        </div>
    </section>

    <main id="celestial-sanctuary" style="display: none;">
        <div class="background-container">
            <canvas id="web-canvas-main"></canvas>
            <canvas id="spiral-canvas-main"></canvas>
            <canvas id="particles-canvas"></canvas>
        </div>

        <div id="mood-sync-bar">
            <div id="mood-sync-content">
                
                <div class="mood-selector">
                    <span class="mood-label">Nic:</span>
                    <div class="mood-picker-dropdown">
                        <button id="nic-current-mood" class="current-mood-btn">
                            <span class="mood-emoji">‚ú®</span>
                            <span class="mood-name">Neutral</span>
                        </button>
                        <div id="nic-mood-options" class="mood-options"></div>
                    </div>
                </div>
                
                <div class="mood-center">
                    <div class="combined-mood-display">
                        <span class="combined-icon">üíï</span>
                        <span class="combined-text">Neutral / Neutral</span>
                    </div>
                    <canvas id="mood-particles"></canvas>
                </div>

                <div class="mood-settings">
                    <label class="switch" title="Toggle Mood Sync">
                        <input type="checkbox" id="mood-sync-toggle">
                        <span class="slider round"></span>
                    </label>
                </div>

                <div class="mood-selector">
                    
                    <div class="mood-picker-dropdown">
                        <button id="zoya-current-mood" class="current-mood-btn">
                            <span class="mood-emoji">‚ú®</span>
                            <span class="mood-name">Neutral</span>
                        </button>
                        <div id="zoya-mood-options" class="mood-options"></div>
                    </div>
                    <span class="mood-label">Zoya:</span>
                </div>

            </div>
            </div>
        
        <button id="mood-sync-visibility-toggle" title="Toggle Mood Bar">
            <span>‚ñº</span>
        </button>
        <div id="mood-recommendation-popup" class="mood-popup">
            <div class="mood-popup-content">
                <button class="mood-popup-close">√ó</button>
                <div class="mood-popup-icon">‚ú®</div>
                <h4 class="mood-popup-title">Cosmic Guidance</h4>
                <p class="mood-popup-message">The stars sense your combined mood. Would you like to be guided?</p>
                <button class="btn primary mood-popup-action" data-target="home">Guide Me</button>
            </div>
        </div>

        <div id="main-menu-container">
            <div id="main-menu-button">
                <img id="menu-icon-img" src="photos/favicon1.png" alt="Menu">
            </div>
            <nav id="main-menu-dropdown">
                <a href="#home" onclick="closeMenu()">Home</a>
                <a href="#chronicle" onclick="closeMenu()">Our Chronicle</a>
                <a href="#tome" onclick="closeMenu()">The Stardust Tome</a>
                <a href="#gallery" onclick="closeMenu()">Gallery of Ages</a>
                <a href="#discover" onclick="closeMenu()">Realms of Discovery</a>
                <a href="#guide" onclick="closeMenu()">Constellation Guide</a>
                <a href="#games" onclick="closeMenu()">Orion's Challenges</a>
                <a href="#universes" onclick="closeMenu()">Alternate Chronicles</a>
                <a href="#voice-garden" onclick="closeMenu()">Voice Garden</a>
                <a href="#sanctum" onclick="closeMenu()">Inner Sanctum</a>
            </nav>
        </div>

        <div id="solar-system-container">
            <div id="music-player-sun">
                <div class="sun-surface">
                    <img id="sun-album-art" src="photos/photo1.jpg" alt="Album Art">
                </div>
                <div id="music-player-panel">
                    <div id="player-view-now-playing" class="player-view active">
                        <img id="panel-album-art" src="photos/photo1.jpg" alt="Album Art">
                        <div id="song-info">
                            <div id="song-title">Song Title</div>
                            <div id="song-artist">Artist</div>
                        </div>
                        <div id="progress-bar-container"><div id="progress-bar"></div></div>
                        <div id="time-container">
                            <span id="current-time">0:00</span>
                            <span id="total-duration">0:00</span>
                        </div>
                        <div id="music-controls">
                            <button id="prev-btn" class="control-btn">‚èÆ</button>
                            <button id="play-pause-btn" class="control-btn">‚ñ∂Ô∏è</button>
                            <button id="next-btn" class="control-btn">‚è≠</button>
                            <button id="shuffle-btn" class="control-btn">üîÄ</button>
                        </div>
                        <div id="volume-container">
                            <span>üîà</span>
                            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
                            <span>üîä</span>
                        </div>
                    </div>
                    <div id="player-view-playlist" class="player-view">
                        <h4>Playlist</h4>
                        <div>
                            <button class="btn" id="upload-music-btn">Upload Song</button>
                            <input type="file" id="music-upload-input" hidden accept="audio/*">
                        </div>
                        <div id="playlist"></div>
                    </div>
                    <div class="player-tabs">
                        <button class="player-tab-btn active" data-view="now-playing" title="Now Playing">üéµ</button>
                        <button class="player-tab-btn" data-view="playlist" title="Playlist">üìú</button>
                    </div>
                </div>
            </div>
            <div id="planet-name-display"></div>
        </div>

        <main class="main-content"></main>

        <button id="scroll-to-top" title="Go to top">‚Üë</button>

    </main>

    <div id="book-password-gate" class="modal">
        <div class="modal-content">
            <div class="tome-lock-icon"></div>
            <h2 class="tome-title">The Stardust Tome</h2>
            <p class="tome-subtitle">This chronicle is sealed by a password known only to its authors.</p>
            <label class="speak-words-label">Speak the words to unseal the tome:</label>
            <input type="password" id="book-password-input" class="text-input tome-input" placeholder="Password...">
            <button id="unlock-book-btn" class="btn primary tome-unlock-btn">
                <span class="btn-icon">‚ú®</span> Unseal
            </button>
            <p class="hint-text">Hint: What is Nini's simple nickname?</p>
        </div>
    </div>

    <div id="chapter-meta-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <h3 class="panel-header">New Chapter Details</h3>
            <div class="form-group">
                <label for="new-chapter-title">Chapter Title</label>
                <input type="text" id="new-chapter-title" class="text-input" placeholder="e.g., The Day We Met">
            </div>
            <div class="form-group">
                <label for="new-chapter-author">Author(s)</label>
                <input type="text" id="new-chapter-author" class="text-input" value="Nini & Zoya">
            </div>
            <div class="form-group">
                <label for="new-chapter-date">Date</label>
                <input type="date" id="new-chapter-date" class="text-input">
            </div>
            <div class="modal-actions">
                <button class="btn" id="cancel-meta-btn">Cancel</button>
                <button class="btn primary" id="continue-meta-btn">Continue to Editor</button>
            </div>
        </div>
    </div>

    <div id="editor-modal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <h3 id="editor-title">Edit Chapter</h3>
            <div class="form-group" id="universe-chapter-title-group" style="display: none; margin-bottom: 1rem;">
                <label for="universe-new-chapter-title">Chapter Title</label>
                <input type="text" id="universe-new-chapter-title" class="text-input" placeholder="Enter the title for your new chapter...">
            </div>
            <div id="quill-editor-container">
                <div id="quill-editor"></div>
            </div>
            <div class="modal-actions">
                <button class="btn" id="cancel-edit-btn">Cancel</button>
                <button class="btn primary" id="save-edit-btn">Save Changes</button>
            </div>
        </div>
    </div>

    <div id="lightbox" class="modal">
        <div class="lightbox-content">
            <img src="" alt="Lightbox image" id="lightbox-img" class="lightbox-image">
            <div class="lightbox-info">
                <p id="lightbox-caption">Caption</p>
            </div>
        </div>
        <button class="lightbox-nav lightbox-close">√ó</button>
        <button class="lightbox-nav lightbox-prev">‚Äπ</button>
        <button class="lightbox-nav lightbox-next">‚Ä∫</button>
    </div>

    <div id="timeline-event-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <h3 id="timeline-modal-title">New Timeline Event</h3>
            <input type="date" id="timeline-modal-date" class="text-input" style="margin-bottom: 1rem;">
            <input type="text" id="timeline-modal-title-input" class="text-input" placeholder="Event Title" style="margin-bottom: 1rem;">
            <textarea id="timeline-modal-desc" class="text-input" rows="4" placeholder="Description..." style="margin-bottom: 1rem;"></textarea>
            <input type="hidden" id="timeline-modal-edit-index">
            <div class="modal-actions">
                <button class="btn" id="timeline-modal-cancel">Cancel</button>
                <button class="btn primary" id="timeline-modal-save">Save Event</button>
            </div>
        </div>
    </div>
    
    <div id="discover-item-modal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <h3 id="discover-modal-title">Add New Destination</h3>
            <div class="discover-modal-layout" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div>
                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="discover-title-input" class="text-input" placeholder="e.g., Okinawa Beaches">
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="discover-location-input" class="text-input" placeholder="e.g., Okinawa, Japan">
                    </div>
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" id="discover-date-input" class="text-input">
                    </div>
                    <div class="form-group">
                        <label>Map Link</label>
                        <input type="text" id="discover-link-input" class="text-input" placeholder="https://maps.google.com/...">
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="discover-status-select" class="text-input">
                            <option value="wishlist">Wishlist</option>
                            <option value="planned">Planned</option>
                            <option value="visited">Visited</option>
                        </select>
                    </div>
                </div>
                <div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="discover-desc-input" class="text-input" rows="8" placeholder="Our dream..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Photos</label>
                        <div id="discover-photo-upload-area">Click here to upload photos</div>
                        <input type="file" id="discover-photo-input" hidden multiple accept="image/*">
                        <div id="discover-photo-previews"></div>
                    </div>
                </div>
            </div>
            <input type="hidden" id="discover-modal-edit-id">
            <div class="modal-actions">
                <button class="btn" id="discover-modal-cancel">Cancel</button>
                <button class="btn primary" id="discover-modal-save">Save Destination</button>
            </div>
        </div>
    </div>
    
    <div id="game-play-modal" class="reward-modal">
        <div class="game-play-modal-content">
            <span class="close-button" onclick="closeGame()">√ó</span>
            <div id="game-play-area"></div>
        </div>
    </div>
    <div id="reward-modal" class="reward-modal">
        <div class="reward-modal-content">
            <span class="close-button" onclick="closeRewardModal()">√ó</span>
            <h2 id="reward-title">A Reward from the Cosmos!</h2>
            <div id="reward-display"></div>
        </div>
    </div>

    <div id="voice-playback-modal" class="voice-playback-modal modal">
        <div class="voice-playback-content">
            <div class="playback-header">
                <h4 id="playback-title">Playing Message...</h4>
                <button class="playback-close" id="playback-close-btn">√ó</button>
            </div>
            <div class="waveform-container" id="playback-waveform"></div>
            <div class="playback-progress" id="playback-progress-bar">
                <div class="playback-progress-fill" id="playback-progress-fill"></div>
            </div>
            <div class="playback-time">
                <span id="playback-current-time">0:00</span>
                <span id="playback-total-duration">0:00</span>
            </div>
            <div class="playback-controls">
                <button class="playback-btn" id="playback-rewind-btn">‚èÆÔ∏è</button>
                <button class="playback-btn" id="playback-play-pause-btn">‚ñ∂Ô∏è</button>
                <button class="playback-btn" id="playback-forward-btn">‚è≠Ô∏è</button>
            </div>
            <div class="playback-metadata">
                <div class="metadata-row">
                    <span class="metadata-label">From:</span>
                    <span id="playback-from" class="metadata-value"></span>
                </div>
                <div class="metadata-row">
                    <span class="metadata-label">Date:</span>
                    <span id="playback-date" class="metadata-value"></span>
                </div>
                <div class="metadata-row">
                    <span class="metadata-label">Note:</span>
                    <span id="playback-note" class="metadata-value"></span>
                </div>
                 <div class="metadata-row">
                    <button class="voice-action-btn" id="playback-transcript-btn" style="display:none; padding:6px 10px;">Transcript</button>
                </div>
            </div>
            <div class="voice-actions">
                <button class="voice-action-btn" id="playback-like-btn">üëç Like</button>
                <button class="voice-action-btn" id="playback-fav-btn">‚òÜ Favorite</button>
                <button class="voice-action-btn" id="playback-delete-btn">üóëÔ∏è Delete</button>
            </div>
        </div>
    </div>
    
    <div id="blessingModal" class="modal">
        <div class="modal-content">
            <span class="modal-icon" id="modalIcon"></span>
            <h2 class="modal-title" id="modalTitle"></h2>
            <div class="modal-message" id="modalMessage"></div>
            <div class="modal-seal"></div>
            <button class="btn primary accept-button" id="accept-blessing-btn">‚úß ACCEPT ‚úß</button>
        </div>
    </div>
    <div id="bookModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title" id="bookTitle"></h2>
            <div class="book-modal-content">
                <p id="bookContent"></p>
            </div>
            <button class="btn primary accept-button" id="close-tome-btn">‚úß CLOSE TOME ‚úß</button>
        </div>
    </div>

    <div id="artifact-modal" class="artifact-detail-modal modal">
        <div class="artifact-modal-content">
            <span class="artifact-modal-close">√ó</span>
            <div class="artifact-modal-icon" id="modal-artifact-icon">üìñ</div>
            <h3 id="modal-artifact-title">Artifact Name</h3>
            <div class="artifact-modal-story" id="modal-artifact-story">Story goes here...</div>
            <div class="artifact-acquisition">
                <span class="acquisition-label">Acquired:</span>
                <span class="acquisition-date" id="modal-artifact-date">2019 - 2021</span>
            </div>
        </div>
    </div>
    <div id="artifact-upload-modal" class="artifact-detail-modal modal">
        <div class="artifact-modal-content" style="text-align: left;">
            <span class="artifact-modal-close">√ó</span>
            <h3 style="text-align: center;">Add a New Sacred Artifact</h3>
            <div class="form-group" style="margin-bottom: 1rem;">
                <label for="artifact-icon-input">Icon (Emoji)</label>
                <input type="text" id="artifact-icon-input" class="text-input" placeholder="e.g., üéüÔ∏è">
            </div>
            <div class="form-group" style="margin-bottom: 1rem;">
                <label for="artifact-title-input">Artifact Name</label>
                <input type="text" id="artifact-title-input" class="text-input" placeholder="e.g., Movie Ticket">
            </div>
            <div class="form-group" style="margin-bottom: 1rem;">
                <label for="artifact-story-input">Story / Significance</label>
                <textarea id="artifact-story-input" class="text-input" rows="3" placeholder="e.g., From our first movie date..."></textarea>
            </div>
            <div class="modal-actions" style="justify-content: center;">
                <button class="btn primary" id="save-artifact-btn">Save Artifact</button>
            </div>
        </div>
    </div>

    <div id="universe-editor-modal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <h3 id="universe-modal-title">Create New Universe</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div>
                    <div class="form-group">
                        <label>Universe ID (e.g., 'ancient_china')</label>
                        <input type="text" id="universe-id-input" class="text-input" placeholder="unique_id (no spaces)">
                    </div>
                    <div class="form-group">
                        <label>Title (e.g., 'The Scholar & The Artist')</label>
                        <input type="text" id="universe-title-input" class="text-input">
                    </div>
                    <div class="form-group">
                        <label>Era (e.g., 'Ancient China (206 BCE)')</label>
                        <input type="text" id="universe-era-input" class="text-input">
                    </div>
                    <div class="form-group">
                        <label>Icon (e.g., 'üèõÔ∏è')</label>
                        <input type="text" id="universe-icon-input" class="text-input">
                    </div>
                    <div class="form-group">
                        <label>Image Path (e.g., 'photos/alternate_universe/new.png')</label>
                        <input type="text" id="universe-image-input" class="text-input">
                    </div>
                </div>
                <div>
                    <div class="form-group">
                        <label>Nic's Name (e.g., 'Nicholai of the West')</label>
                        <input type="text" id="universe-nic-name-input" class="text-input">
                    </div>
                    <div class="form-group">
                        <label>Nic's Role (e.g., 'Scholar & Mathematician')</label>
                        <input type="text" id="universe-nic-role-input" class="text-input">
                    </div>
                    <div class="form-group">
                        <label>Zoya's Name (e.g., 'Zhang Zoya')</label>
                        <input type="text" id="universe-zoya-name-input" class="text-input">
                    </div>
                    <div class="form-group">
                        <label>Zoya's Role (e.g., 'Imperial Calligrapher')</label>
                        <input type="text" id="universe-zoya-role-input" class="text-input">
                    </div>
                </div>
            </div>
            <div class="form-group" style="grid-column: 1 / -1;">
                <label>Premise</label>
                <textarea id="universe-premise-input" class="text-input" rows="3" placeholder="A brief summary of this universe..."></textarea>
            </div>
            <div class="modal-actions">
                <button class="btn" id="universe-modal-cancel">Cancel</button>
                <button class="btn primary" id="universe-modal-save">Save Universe</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script type="module" src="js/main.js"></script>
    <script src="js/chinese_enhancements.js"></script>

</body>
</html>