<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>⟐ INNER SANCTUM ⟐</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700;900&family=Philosopher:ital,wght@0,400;0,700;1,400&family=UnifrakturMaguntia&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Philosopher', sans-serif;
            background: #000;
            color: #d4af37;
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
        }
        
        .starfield {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: radial-gradient(ellipse at center, #1a1a3e 0%, #000 100%);
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        .shooting-star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            box-shadow: 0 0 10px 2px white;
            animation: shoot 3s ease-in infinite;
        }
        
        .nebula {
            position: absolute;
            width: 400px;
            height: 400px;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            animation: nebulaDrift 30s ease-in-out infinite;
        }

        @keyframes shoot {
            0% { transform: translateX(0) translateY(0); opacity: 1; }
            100% { transform: translateX(-300px) translateY(300px); opacity: 0; }
        }
        
        @keyframes nebulaDrift {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(100px, -100px); }
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes glow {
            0%, 100% { text-shadow: 0 0 10px #d4af37, 0 0 20px #d4af37, 0 0 30px #d4af37; }
            50% { text-shadow: 0 0 20px #ffd700, 0 0 40px #ffd700, 0 0 60px #ffd700, 0 0 80px #d4af37; }
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 80px #d4af37; }
            50% { transform: scale(1.05); box-shadow: 0 0 120px #ffd700; }
        }
        
        @keyframes modalAppear {
            from { opacity: 0; transform: scale(0.7) rotateY(-180deg); }
            to { opacity: 1; transform: scale(1) rotateY(0deg); }
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; transform: translateX(-50%) scale(1); }
            50% { opacity: 0.8; transform: translateX(-50%) scale(0.95); }
        }
        
        @keyframes runeGlow {
            0%, 100% { opacity: 0.4; transform: rotate(0deg); }
            50% { opacity: 1; transform: rotate(180deg); }
        }
        
        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            will-change: transform; /* Added for smoother scrolling */
        }
        
        .rune {
            position: fixed;
            font-size: 24px;
            color: #d4af37;
            opacity: 0.3;
            animation: runeGlow 8s ease-in-out infinite;
            pointer-events: none;
            z-index: 2;
        }
        
        .header {
            text-align: center;
            margin-bottom: 60px;
            animation: float 4s ease-in-out infinite;
        }
        
        .ancient-seal {
            width: 150px;
            height: 150px;
            margin: 0 auto 30px;
            border: 3px solid #d4af37;
            border-radius: 50%;
            position: relative;
            animation: rotate 20s linear infinite;
        }
        
        .ancient-seal::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 80%;
            border: 2px solid #b8860b;
            border-radius: 50%;
            animation: rotate 15s linear infinite reverse;
        }
        
        .ancient-seal::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50%;
            height: 50%;
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            background: radial-gradient(circle, #ffd700 0%, #d4af37 100%);
            border: none;
        }
        
        .title {
            font-family: 'Cinzel', serif;
            font-size: 4em;
            margin-bottom: 20px;
            animation: glow 3s ease-in-out infinite;
            letter-spacing: 6px;
            font-weight: 900;
        }
        
        .subtitle {
            font-size: 1.5em;
            color: #b8860b;
            font-style: italic;
            margin-bottom: 15px;
            letter-spacing: 3px;
        }
        
        .ancient-text {
            font-family: 'UnifrakturMaguntia', cursive;
            font-size: 1.1em;
            color: #8b7355;
            letter-spacing: 2px;
            margin-top: 10px;
        }
        
        .scroll-entrance {
            text-align: center;
            margin: 80px 0;
        }

        .portal-ring {
            width: 250px;
            height: 250px;
            margin: 30px auto;
            border: 3px solid #d4af37;
            border-radius: 50%;
            position: relative;
            animation: rotate 20s linear infinite;
            box-shadow: 0 0 40px #d4af37, inset 0 0 40px #d4af37;
        }
        
        .portal-ring::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 180px;
            height: 180px;
            border: 2px solid #b8860b;
            border-radius: 50%;
            animation: rotate 15s linear infinite reverse;
        }
        
        .portal-ring::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            border: 2px dashed #8b7355;
            border-radius: 50%;
            animation: rotate 10s linear infinite;
        }
        
        .enter-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1a1a3e 0%, #0a0e27 100%);
            color: #d4af37;
            border: 2px solid #d4af37;
            padding: 20px 45px;
            font-family: 'Cinzel', serif;
            font-size: 1.3em;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 50px;
            letter-spacing: 3px;
            font-weight: 600;
        }
        
        .enter-button:hover {
            background: #d4af37;
            color: #0a0e27;
            box-shadow: 0 0 40px #ffd700;
            transform: translate(-50%, -50%) scale(1.15);
        }

        .prophecy-text {
            margin-top: 30px;
            font-style: italic;
            color: #b8860b;
            line-height: 1.8;
            font-size: 1.1em;
        }
        
        .sacred-scroll {
            max-width: 600px;
            margin: 0 auto;
            padding: 50px;
            background: linear-gradient(to bottom, #1a1410, #0a0705);
            border: 3px solid #d4af37;
            border-radius: 20px;
            box-shadow: 0 0 60px rgba(212, 175, 55, 0.5);
            position: relative;
        }
        
        .sacred-scroll::before {
            content: '⟐ ☥ ☽ ☾ ✦ ⟐';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 1.5em;
            color: #d4af37;
            opacity: 0.5;
        }
        
        .question-box {
            margin: 40px 0;
            padding: 30px;
            background: rgba(26, 26, 62, 0.5);
            border: 2px solid #8b7355;
            border-radius: 15px;
        }
        
        .question {
            font-size: 1.3em;
            color: #ffd700;
            margin-bottom: 25px;
            font-family: 'Cinzel', serif;
            text-align: center;
        }
        
        .choice-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .choice-button {
            background: linear-gradient(135deg, #1a1a3e 0%, #0f1235 100%);
            border: 2px solid #8b7355;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Philosopher', serif;
            font-size: 1.1em;
            color: #d4af37;
            text-align: center;
            flex-basis: calc(50% - 10px);
            min-width: 200px;
        }
        
        .choice-button:hover {
            background: linear-gradient(135deg, #d4af37 0%, #b8860b 100%);
            color: #000;
            border-color: #ffd700;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.6);
            transform: translateY(-5px);
        }
        
        .hidden { display: none; }
        .realm { display: none; }
        .realm.active { display: block; }

        .realm-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 35px;
            margin: 60px 0;
        }
        
        .realm-portal {
            background: linear-gradient(135deg, #1a1a3e 0%, #0f1235 100%);
            border: 3px solid #d4af37;
            padding: 40px 30px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.4s;
            position: relative;
            text-align: center;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .realm-portal:hover {
            transform: translateY(-15px) scale(1.03);
            box-shadow: 0 20px 60px rgba(212, 175, 55, 0.6);
            border-color: #ffd700;
        }
        
        .realm-icon {
            font-size: 5em;
            margin-bottom: 20px;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 0 20px currentColor);
        }
        
        .realm-title {
            font-family: 'Cinzel', serif;
            font-size: 1.8em;
            color: #ffd700;
            margin-bottom: 15px;
            letter-spacing: 2px;
            text-align: center;
        }
        
        .realm-description {
            color: #b8860b;
            font-size: 1em;
            line-height: 1.8;
            font-style: italic;
        }
        
        .section-title {
            font-family: 'Cinzel', serif;
            font-size: 2.8em;
            text-align: center;
            margin: 60px 0 40px;
            color: #ffd700;
            letter-spacing: 4px;
            position: relative;
        }
        
        .section-title::before,
        .section-title::after {
            content: '⟐';
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.8em;
            opacity: 0.6;
        }
        
        .section-title::before { left: 10%; }
        .section-title::after { right: 10%; }
        
        .oracle-chamber {
            text-align: center;
            margin: 80px 0;
            padding: 60px 40px;
            background: linear-gradient(135deg, rgba(26, 26, 62, 0.7) 0%, rgba(10, 14, 39, 0.7) 100%);
            border: 3px solid #d4af37;
            border-radius: 30px;
            box-shadow: 0 0 80px rgba(212, 175, 55, 0.4);
        }
        
        .crystal-ball {
            width: 200px;
            height: 200px;
            margin: 30px auto;
            background: radial-gradient(circle at 30% 30%, #ffd700 0%, #d4af37 50%, #1a1a3e 100%);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
            cursor: pointer;
            position: relative;
        }
        
        .crystal-ball::after {
            content: '✧';
            position: absolute;
            top: 25%;
            left: 30%;
            font-size: 2em;
            color: white;
            text-shadow: 0 0 20px white;
            animation: twinkle 2s ease-in-out infinite;
        }
        
        .oracle-text {
            font-size: 1.4em;
            color: #ffd700;
            font-style: italic;
            line-height: 2;
            margin-top: 30px;
            min-height: 80px;
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }
        
        .astral-map {
            position: relative;
            min-height: 500px;
            margin: 80px 0;
            padding: 40px;
            border: 3px solid #8b7355;
            border-radius: 30px;
            background: linear-gradient(135deg, rgba(26, 26, 62, 0.5) 0%, rgba(10, 14, 39, 0.5) 100%);
        }
        
        .astral-point {
            position: absolute;
            width: 16px;
            height: 16px;
            background: #d4af37;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 15px #d4af37;
        }
        
        .astral-point:hover {
            transform: scale(2.5);
            box-shadow: 0 0 40px #ffd700;
            z-index: 10;
        }
        
        .astral-line {
            position: absolute;
            height: 2px;
            background: linear-gradient(to right, transparent, #8b7355, transparent);
            transform-origin: left center;
            opacity: 0.4;
        }

        .ritual-altar {
            margin: 80px 0;
            padding: 60px;
            background: linear-gradient(135deg, #1a1410 0%, #0a0705 100%);
            border: 3px solid #d4af37;
            border-radius: 30px;
            box-shadow: 0 0 80px rgba(212, 175, 55, 0.3);
            text-align: center;
        }
        
        .candles {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 40px 0;
            flex-wrap: wrap;
        }
        
        .candle {
            width: 30px;
            height: 80px;
            background: linear-gradient(to bottom, #8b4513 0%, #654321 100%);
            border-radius: 5px 5px 0 0;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .candle::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 25px;
            background: radial-gradient(ellipse at center, #ffd700 0%, #ff6600 50%, transparent 100%);
            border-radius: 50% 50% 0 0;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .candle.lit::before {
            opacity: 1;
            animation: flicker 0.5s ease-in-out infinite;
        }
        
        .ritual-instructions {
            font-size: 1.2em;
            color: #b8860b;
            line-height: 2;
            margin: 30px 0;
        }
        
        .ritual-complete {
            display: none;
            font-size: 1.5em;
            color: #ffd700;
            margin-top: 30px;
            animation: glow 2s ease-in-out infinite;
        }

        .sacred-library {
            margin: 80px 0;
        }
        
        .book-shelf {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }
        
        .book {
            background: linear-gradient(135deg, #5c4033 0%, #3d2817 100%);
            border: 2px solid #d4af37;
            border-radius: 10px;
            padding: 30px 25px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .book:hover {
            transform: translateY(-10px) rotateY(10deg);
            box-shadow: 0 15px 40px rgba(212, 175, 55, 0.4);
        }
        
        .book-title {
            font-family: 'Cinzel', serif;
            font-size: 1.3em;
            color: #ffd700;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .book-description {
            color: #b8860b;
            font-size: 0.95em;
            line-height: 1.6;
            text-align: center;
        }
        
        /* Scratch Card Styles */
        .scratch-card-container {
            position: relative;
            width: 90%;
            max-width: 500px;
            aspect-ratio: 16 / 10;
            margin: 40px auto;
            cursor: crosshair;
            border: 3px solid #d4af37;
            border-radius: 20px;
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.5);
        }

        .scratch-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 17px;
        }

        .prize-div {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a3e 0%, #0a0e27 100%);
            border-radius: 17px;
        }
        
        .prize-title {
             font-family: 'Cinzel', serif;
            font-size: 2em;
            color: #ffd700;
        }
        
        .prize-description {
            font-size: 1.2em;
            margin-top: 15px;
            color: #b8860b;
            font-style: italic;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active { display: flex; }
        
        .modal-content {
            background: linear-gradient(135deg, #1a1a3e 0%, #0a0e27 100%);
            border: 4px solid #d4af37;
            border-radius: 30px;
            padding: 60px;
            max-width: 700px;
            text-align: center;
            position: relative;
            animation: modalAppear 0.6s ease-out;
            box-shadow: 0 0 100px rgba(212, 175, 55, 0.7);
        }
        
        .modal-content::before {
            content: '⟐';
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3em;
            color: #ffd700;
            text-shadow: 0 0 40px #ffd700;
        }
        
        .modal-icon {
            font-size: 6em;
            margin-bottom: 25px;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 0 20px currentColor);
        }
        
        .modal-title {
            font-family: 'Cinzel', serif;
            font-size: 2.8em;
            margin-bottom: 25px;
            color: #ffd700;
            letter-spacing: 2px;
            text-align: center;
        }
        
        .modal-message {
            font-size: 1.3em;
            line-height: 2;
            margin-bottom: 35px;
            color: #d4af37;
        }

        .modal-message .promise {
            display: block;
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px dashed #8b7355;
            font-style: italic;
            color: #ffd700;
        }
        
        .modal-seal {
            width: 100px;
            height: 100px;
            margin: 30px auto;
            border: 2px solid #d4af37;
            border-radius: 50%;
            position: relative;
            animation: rotate 10s linear infinite;
        }
        
        .modal-seal::after {
            content: '⊛';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3em;
            color: #ffd700;
        }
        
        .accept-button {
            background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%);
            color: #000;
            border: none;
            padding: 20px 50px;
            font-family: 'Cinzel', serif;
            font-size: 1.2em;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.3s;
            letter-spacing: 3px;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.5);
        }
        
        .accept-button:hover {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            box-shadow: 0 15px 50px rgba(255, 215, 0, 0.7);
            transform: scale(1.1);
        }
        
        .footer {
            text-align: center;
            margin-top: 100px;
            padding: 60px;
            color: #8b7355;
            font-size: 1em;
            border-top: 2px solid #8b7355;
        }
        
        #scroll-to-top {
            display: none;
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 2001;
            border: none;
            outline: none;
            background-color: #d4af37;
            color: #02041b;
            cursor: pointer;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 24px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.7);
            transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
        }
        #scroll-to-top:hover {
            background-color: #fff3c4;
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .title { font-size: 2.5em; }
            .realm-grid, .book-shelf { grid-template-columns: 1fr; }
            .section-title::before, .section-title::after { display: none; }
            .choice-button { flex-basis: 100%; }
            .subtitle, .prophecy-text { text-align: center; } /* Alignment fix */
            .question-box { text-align: center; } /* Alignment fix */
            .sacred-scroll { padding: 30px; }
            .enter-button:hover {
                 /* Adjust scaling slightly for better touch feedback */
                transform: translate(-50%, -50%) scale(1.05); 
            }
        }
    </style>
</head>
<body>
    <div class="starfield" id="starfield"></div>
    
    <div class="container">
        <div class="rune" style="top: 10%; left: 5%;">☽</div>
        <div class="rune" style="top: 20%; right: 8%;">☾</div>
        <div class="rune" style="top: 40%; left: 3%;">✦</div>
        <div class="rune" style="top: 60%; right: 5%;">⟐</div>
        <div class="rune" style="top: 80%; left: 10%;">◈</div>
        <div class="rune" style="top: 70%; right: 12%;">☥</div>
        
        <header class="header">
            <div class="ancient-seal"></div>
            <h1 class="title">⟐ INNER SANCTUM ⟐</h1>
            <p class="subtitle">Where Celestial Powers Heal All Wounds</p>
            <p class="ancient-text">∾ Forged in the First Light of Creation ∾</p>
        </header>
        
        <main id="entranceSection">
            <div class="scroll-entrance" id="scrollEntrance">
                <div class="sacred-scroll">
                    <h2 style="font-family: 'Cinzel', serif; font-size: 2em; color: #ffd700; margin-bottom: 20px; text-align: center;">
                        The Portal Awaits
                    </h2>
                    <p style="color: #b8860b; line-height: 1.8; margin-bottom: 30px;">
                        Beyond this threshold lies a realm where cosmic forces bend to will,
                        where sadness transforms to joy, and where love's power knows no bounds.
                    </p>
                    <div class="portal-ring">
                        <button class="enter-button" onclick="showWelcomeQuestion()">ENTER</button>
                    </div>
                    <p class="prophecy-text">
                        "She who crosses this threshold shall find solace eternal,<br>
                        Blessings of power await those pure of heart."
                    </p>
                </div>
            </div>

            <div id="welcomeQuestion" class="hidden">
                <div class="sacred-scroll">
                    <h2 style="font-family: 'Cinzel', serif; font-size: 2.2em; color: #ffd700; margin-bottom: 30px; text-align: center;">
                        Welcome, Precious Soul
                    </h2>
                    <p style="color: #b8860b; line-height: 2; margin-bottom: 40px; font-size: 1.1em;">
                        The cosmos has guided you here. This sanctuary was crafted by ancient forces and boundless love,
                        a place where comfort awaits, where achievements are celebrated, where understanding flows freely,
                        and where wisdom whispers through the stars.
                    </p>
                    <div class="question-box">
                        <p class="question">How does your spirit feel in this moment?</p>
                        <div class="choice-buttons">
                            <button class="choice-button" onclick="showRealm('comfort')">💫<br>I seek comfort</button>
                            <button class="choice-button" onclick="showRealm('celebrate')">✨<br>I achieved something</button>
                            <button class="choice-button" onclick="showRealm('hurt')">🌙<br>Something hurt me</button>
                            <button class="choice-button" onclick="showRealm('guidance')">🔮<br>I need guidance</button>
                            <button class="choice-button" onclick="showRealm('fortune')" style="flex-basis: 100%;">🎲<br>A Game of Fortune</button>
                        </div>
                    </div>
                    <p style="color: #8b7355; font-size: 0.9em; font-style: italic; margin-top: 30px;">
                        "Choose with your heart, and the universe shall respond"
                    </p>
                </div>
            </div>
        </main>
        
        <section id="comfortRealm" class="realm">
            <h2 class="section-title">✧ The Realm of Comfort ✧</h2>
            <p style="text-align: center; color: #b8860b; font-style: italic; margin-bottom: 40px; font-size: 1.2em;">
                "When sadness weighs heavy, these portals and texts open to ease your burden"
            </p>
            <div class="sacred-library">
                 <div class="book-shelf">
                    <div class="book" onclick="readBook('comfort', 'Scrolls of Solace', 'When sadness descends like night, remember: dawn always comes. The universe has weathered countless storms and always finds balance. Your feelings are valid, your pain is real, but neither are permanent. This too shall pass, and joy will return like spring after winter.')">
                        <div class="book-title">📜 Scrolls of Solace</div>
                        <p class="book-description">Words to heal the weary heart</p>
                    </div>
                    <div class="book" onclick="readBook('magic', 'The Grimoire of Daily Miracles', 'Magic exists in the mundane: in breakfast made with love, in texts that say ‘thinking of you’, in remembering how she takes her tea. Pay attention to these small enchantments—they are the true sorcery that sustains love.')">
                        <div class="book-title">✨ The Grimoire of Daily Miracles</div>
                        <p class="book-description">Finding magic in everyday moments</p>
                    </div>
                </div>
            </div>
            <div class="realm-grid">
                <div class="realm-portal" onclick="revealDynamicBlessing('comfort', '🫂', 'Warmth & Presence')">
                    <div class="realm-icon">🫂</div>
                    <h3 class="realm-title">Warmth & Presence</h3>
                    <p class="realm-description">For when you need to feel held</p>
                </div>
                <div class="realm-portal" onclick="revealDynamicBlessing('sweet', '🍰', 'Sweet Solace')">
                    <div class="realm-icon">🍰</div>
                    <h3 class="realm-title">Sweet Comfort</h3>
                    <p class="realm-description">For when you crave sweetness</p>
                </div>
                <div class="realm-portal" onclick="revealDynamicBlessing('pamper', '🌸', 'Sacred Restoration')">
                    <div class="realm-icon">🌸</div>
                    <h3 class="realm-title">Rejuvenation</h3>
                    <p class="realm-description">For when you need renewal</p>
                </div>
                <div class="realm-portal" onclick="revealDynamicBlessing('qualityTime', '⏳', 'Timeless Together')">
                    <div class="realm-icon">⏳</div>
                    <h3 class="realm-title">Quality Time</h3>
                    <p class="realm-description">For when you need connection</p>
                </div>
            </div>
            <div style="text-align: center; margin-top: 60px;">
                <button class="choice-button" onclick="returnToWelcome()" style="display: inline-block; width: auto; padding: 15px 40px;">Return to Sanctuary Entrance</button>
            </div>
        </section>
        
        <section id="celebrateRealm" class="realm">
             <h2 class="section-title">✧ The Realm of Triumph ✧</h2>
            <p style="text-align: center; color: #b8860b; font-style: italic; margin-bottom: 40px; font-size: 1.2em;">"Your achievements deserve cosmic celebration"</p>
            <div class="realm-grid">
                <div class="realm-portal" onclick="revealDynamicBlessing('dinner', '🎉', 'Victory Feast')">
                    <div class="realm-icon">🎉</div>
                    <h3 class="realm-title">Celebration Dinner</h3>
                    <p class="realm-description">For worthy accomplishments</p>
                </div>
                <div class="realm-portal" onclick="revealDynamicBlessing('shopping', '✨', 'Reward of Stars')">
                    <div class="realm-icon">✨</div>
                    <h3 class="realm-title">Material Reward</h3>
                    <p class="realm-description">For exceptional achievements</p>
                </div>
                <div class="realm-portal" onclick="revealDynamicBlessing('adventure', '🗺️', 'Victory Quest')">
                    <div class="realm-icon">🗺️</div>
                    <h3 class="realm-title">Adventure Reward</h3>
                    <p class="realm-description">For brave accomplishments</p>
                </div>
                <div class="realm-portal" onclick="revealDynamicBlessing('queen', '👑', 'Day of Glory')">
                    <div class="realm-icon">👑</div>
                    <h3 class="realm-title">Total Authority</h3>
                    <p class="realm-description">For legendary achievements</p>
                </div>
            </div>
            <div style="text-align: center; margin-top: 60px;">
                <button class="choice-button" onclick="returnToWelcome()" style="display: inline-block; width: auto; padding: 15px 40px;">Return to Sanctuary Entrance</button>
            </div>
        </section>
        
        <section id="hurtRealm" class="realm">
            <h2 class="section-title">✧ The Realm of Healing ✧</h2>
            <p style="text-align: center; color: #b8860b; font-style: italic; margin-bottom: 40px; font-size: 1.2em;">"When wrongs must be righted, these pathways and rituals open"</p>
            <div class="ritual-altar">
                <p class="ritual-instructions">"Light each of the seven sacred candles to complete the ancient ritual.<br>With each flame, a burden lifts and harmony returns."</p>
                <div class="candles">
                    <div class="candle" onclick="lightCandle(this)" title="Candle of Understanding"></div>
                    <div class="candle" onclick="lightCandle(this)" title="Candle of Forgiveness"></div>
                    <div class="candle" onclick="lightCandle(this)" title="Candle of Love"></div>
                    <div class="candle" onclick="lightCandle(this)" title="Candle of Joy"></div>
                    <div class="candle" onclick="lightCandle(this)" title="Candle of Peace"></div>
                    <div class="candle" onclick="lightCandle(this)" title="Candle of Renewal"></div>
                    <div class="candle" onclick="lightCandle(this)" title="Candle of Eternity"></div>
                </div>
                <p class="ritual-complete" id="ritualComplete">✧ The Ritual is Complete ✧<br>All is forgiven, all is renewed, all is well.</p>
            </div>
             <div class="realm-grid">
                <div class="realm-portal" onclick="revealDynamicBlessing('apology', '🔮', 'The Sacred Apology')">
                    <div class="realm-icon">🔮</div>
                    <h3 class="realm-title">Truth & Apology</h3>
                    <p class="realm-description">When I have wronged you</p>
                </div>
                <div class="realm-portal" onclick="revealDynamicBlessing('amends', '💝', 'Making Amends')">
                    <div class="realm-icon">💝</div>
                    <h3 class="realm-title">Making Amends</h3>
                    <p class="realm-description">To balance the scales</p>
                </div>
                <div class="realm-portal" onclick="revealDynamicBlessing('burden', '⚡', 'Lifting Your Load')">
                    <div class="realm-icon">⚡</div>
                    <h3 class="realm-title">Lifting Your Load</h3>
                    <p class="realm-description">When life is too heavy</p>
                </div>
                <div class="realm-portal" onclick="revealBlessing('🌟', 'The Ultimate Wish', 'Anything. Whatever you need to feel whole again. No limits, no restrictions. The full power of the cosmos bends to make things right for my one and only love.')">
                    <div class="realm-icon">🌟</div>
                    <h3 class="realm-title">Cosmic Restoration</h3>
                    <p class="realm-description">When only everything will do</p>
                </div>
            </div>
            <div style="text-align: center; margin-top: 60px;">
                <button class="choice-button" onclick="returnToWelcome()" style="display: inline-block; width: auto; padding: 15px 40px;">Return to Sanctuary Entrance</button>
            </div>
        </section>
        
        <section id="guidanceRealm" class="realm">
            <h2 class="section-title">✧ The Realm of Guidance ✧</h2>
             <p style="text-align: center; color: #b8860b; font-style: italic; margin-bottom: 40px; font-size: 1.2em;">"Wisdom flows through ancient channels to guide your path"</p>
            <div class="oracle-chamber">
                <div class="crystal-ball" onclick="revealWisdom()"></div>
                <p style="color: #8b7355; font-style: italic; margin-bottom: 20px;">Click the crystal to receive guidance from the cosmos</p>
                <p class="oracle-text" id="oracleText">The oracle awaits your question...</p>
            </div>
            <div class="astral-map">
                <h3 style="font-family: 'Cinzel', serif; font-size: 2em; color: #ffd700; text-align: center; margin-bottom: 30px;">The Constellation of Our Love</h3>
                 <div id="constellationCanvas" style="position: relative; height: 500px;"></div>
            </div>
            <div style="text-align: center; margin-top: 60px;">
                <button class="choice-button" onclick="returnToWelcome()" style="display: inline-block; width: auto; padding: 15px 40px;">Return to Sanctuary Entrance</button>
            </div>
        </section>

        <section id="fortuneRealm" class="realm">
            <h2 class="section-title">✧ The Realm of Fortune ✧</h2>
            <p style="text-align: center; color: #b8860b; font-style: italic; margin-bottom: 40px; font-size: 1.2em;">"Scratch the cosmic tablet to reveal your fate. Will the stars align in your favor?"</p>
            
            <div class="scratch-card-container">
                <div id="prizeDiv" class="prize-div">
                    <h3 id="prizeTitle" class="prize-title"></h3>
                    <p id="prizeDescription" class="prize-description"></p>
                </div>
                <canvas id="scratchCanvas" class="scratch-canvas"></canvas>
            </div>

            <div style="text-align: center; margin-top: 60px; display: flex; justify-content: center; gap: 20px;">
                <button class="choice-button" onclick="initScratchCard()" style="display: inline-block; width: auto; padding: 15px 40px;">Play Again</button>
                <button class="choice-button" onclick="returnToWelcome()" style="display: inline-block; width: auto; padding: 15px 40px;">Return to Entrance</button>
            </div>
        </section>
        
        <footer class="footer">
            <p style="font-size: 1.1em; margin-bottom: 15px;">⟐ Remember: The universe always finds a way back to harmony ⟐</p>
        </footer>
    </div>
    
    <div class="modal" id="blessingModal">
        <div class="modal-content">
            <span class="modal-icon" id="modalIcon"></span>
            <h2 class="modal-title" id="modalTitle"></h2>
            <div class="modal-message" id="modalMessage"></div>
            <div class="modal-seal"></div>
            <button class="accept-button" onclick="closeModal('blessingModal')">✧ ACCEPT BLESSING ✧</button>
        </div>
    </div>
    <div class="modal" id="bookModal">
        <div class="modal-content">
            <h2 class="modal-title" id="bookTitle" style="font-size: 2.2em;"></h2>
            <div style="margin: 30px 0; padding: 30px; background: rgba(26, 26, 62, 0.3); border-radius: 15px; border: 1px solid #8b7355;">
                <p id="bookContent" style="font-size: 1.2em; line-height: 2; color: #d4af37; text-align: left;"></p>
            </div>
            <button class="accept-button" onclick="closeModal('bookModal')">✧ CLOSE TOME ✧</button>
        </div>
    </div>

    <button id="scroll-to-top" title="Go to top">↑</button>
    
    <script>
        // --- PERSONALIZED CONTENT (Must be duplicated/handled here or sourced externally) ---
        const personalizedContent = {
            apology: [
                "My Zoya (我的宝贝), I'm sorry if I ever get lost in my own world, like I did with that mathematics book on the day we met. You broke through my shyness then, and you deserve all my attention now. 对不起.",
                "I'm sorry if my quietness ever makes you feel distant. Sometimes I'm still that boy who was scared to send a Facebook message, afraid of saying the wrong thing. But my heart is always talking to you.",
                "Forgive me if I ever seem clumsy with my feelings. I'm better at fixing bicycles than expressing what's in my heart, but I promise I'm always trying my best for you.",
                "对不起, my love. I'm sorry if I ever get too focused on my own plans, like when I wanted to rush back from Kyoto. It was only to see you, but your feelings should always come first.",
                "I apologize for any time I've made you feel unseen. You saw me when I felt invisible at the sports festival, and I promise to always see you, the true you.",
                "Sometimes my overthinking gets the best of me, and I'm sorry if that ever causes you worry. You are the calm to my storm, the answer to all my 'what ifs'.",
                "I'm sorry if I'm not always as expressive as I should be. You once called my goodnight message a 'sweet poem', and it meant the world to me. I'll try to write more poems for you.",
                "Forgive my shyness. Remember how I couldn't approach you in art class? I'm so glad we moved past that, and I'm sorry if my hesitation ever made you doubt my feelings.",
                "I'm sorry for being a silly boy who thought girls were 'complicated'. You taught me that love is the simplest, most beautiful thing in the world. Thank you for your patience.",
                "对不起. I'm sorry if my husky voice ever speaks a sharp word. It was the first thing you noticed about me, and I only ever want it to speak words of love and kindness to you."
            ],
            promise: [
                "To make it up to you, I promise to put my world on pause and listen, just like you always listen to me talk about mathematics.",
                "I promise to always come to your home, just like I did when I worried about your dream, to make sure you're okay and see your beautiful smile.",
                "I promise to take you on a date to Joyful, just us, for chicken steak and to remember how our story began.",
                "As compensation, let's have an art date. We can draw together, and I'll sketch your face like I promised, as if you're the first and only person I've ever drawn.",
                "I promise a full day of your favorite Chinese dramas, and I won't complain once. I'll even try to learn some phrases!",
                "To make it right, I'll cook for you, just like your father cooked for me. It's my turn to welcome you with a warm meal and a full heart.",
                "I promise to hold you and never let go, a cuddle more powerful than the typhoon that couldn't keep me away from you."
            ],
            comfort: [
                "Remember when we were two 'forlorn birds in a foreign land'? No matter how lonely the world feels, you are not alone. I'm here, and my heart is your home.",
                "Let my love be like the blanket that covers you when you sleep, chasing away all the worries and pains, just like in the goodnight message I sent.",
                "You are the girl with hair like 'strands of heaven'. Let me gently stroke your hair until all your sadness melts away.",
                "The world saw a boy with a book; you saw me. When you feel down, remember that I will always see the incredible, beautiful you. 我爱你."
            ],
            sweet: [
                "You deserve all the sweet things in the cosmos. Let's get your favorite dessert, find a quiet place, and just be together.",
                "My love for you is sweeter than any cake. But a cake would be nice too, right? Your wish is my command."
            ],
            pamper: [
                "You once appeared in my dreams looking unhappy, and it made me rush to your side. Let me erase all your worries with a day of pure relaxation. You deserve to be treated like the queen you are.",
                "Let me take care of you. A full spa day, a massage, anything you need to feel refreshed and cherished."
            ],
            qualityTime: [
                "Remember our first real 'date' at the library? Let's go back. We don't have to talk, we can just exist in the same space, together. That's all I need.",
                "No phones, no distractions. Just you and me, like that first conversation at the sports festival where the whole world disappeared."
            ],
            dinner: [
                "Let's celebrate your victory! How about we go to Joyful for our special chicken steak? A tribute to the day our journey really began.",
                "Your achievement deserves a feast worthy of your family's hospitality. I'll find the best place to honor you tonight."
            ],
            shopping: [
                "You are a treasure. For this great accomplishment, you deserve a material treasure of your choice. Let's go find something as beautiful as you are.",
            ],
            adventure: [
                "Let's go on a spontaneous adventure! Maybe not as dramatic as me jogging to your house to fix a bicycle, but just as memorable.",
                "You deserve a victory trip. Maybe we can finally take some cityscape photos in Kyoto together."
            ],
            queen: [
                "For the next 24 hours, you are the absolute ruler. Your every wish is my command. No task too great, no request too small for my queen.",
            ],
            amends: [
                "To balance the scales, you can choose your compensation: a trip to the restaurant of your choice, a shopping spree for something that makes you smile, or an adventure to create a new happy memory.",
                "The cosmos demands balance. Therefore, I offer a 'Customized Coupon' just like the one Zoya wanted. You can redeem it for absolutely anything your heart desires."
            ],
            burden: [
                "For one full week, all your chores are mine. No dishes, no worries. Your only job is to rest and feel loved.",
                "Tell me the heaviest thing on your mind. For the next three days, I will carry that worry for you so you can be at peace."
            ]
        };

        function createThemedStarfield(themeName) {
            const starfield = document.getElementById('starfield');
            if (!starfield) return;
            
            const theme = THEME_COLORS[themeName];
            const starShape = THEME_STAR_SHAPES[themeName];
            if (!theme || !starShape) return;

            // Clear existing stars
            starfield.innerHTML = '';
            
            // Apply theme background
            starfield.style.background = theme.bgGradient;
            
            // Create stars with theme-appropriate shapes (REDUCED COUNT)
            for (let i = 0; i < 100; i++) { // Reduced from 300
                const star = document.createElement('div');
                star.className = 'star';
                star.textContent = starShape.char;
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.fontSize = (Math.random() * 10 + 6) + 'px'; // Smaller size range
                star.style.color = theme.colors['--gold'];
                star.style.filter = `drop-shadow(0 0 ${Math.random() * 2 + 1}px ${starShape.shadowColor})`;
                star.style.animationDelay = Math.random() * 3 + 's';
                star.style.animationDuration = (2 + Math.random() * 3) + 's';
                star.style.opacity = (Math.random() * 0.4 + 0.3); // More subtle
                starfield.appendChild(star);
            }
            
            // Create shooting stars (REDUCED COUNT)
            for (let i = 0; i < 2; i++) { // Reduced from 5
                const shootingStar = document.createElement('div');
                shootingStar.className = 'shooting-star';
                shootingStar.textContent = starShape.char;
                shootingStar.style.left = Math.random() * 100 + '%';
                shootingStar.style.top = Math.random() * 50 + '%';
                shootingStar.style.color = theme.colors['--gold'];
                shootingStar.style.filter = `drop-shadow(0 0 8px ${starShape.shadowColor})`;
                shootingStar.style.animationDelay = Math.random() * 10 + 's';
                shootingStar.style.fontSize = '14px';
                starfield.appendChild(shootingStar);
            }
            
            // Create nebulae with theme colors
            const nebulae = [
                { left: '10%', top: '20%' },
                { left: '70%', top: '60%' },
                { left: '40%', top: '80%' }
            ];
            
            nebulae.forEach(neb => {
                const nebula = document.createElement('div');
                nebula.className = 'nebula';
                nebula.style.background = theme.colors['--soft-violet'];
                nebula.style.left = neb.left;
                nebula.style.top = neb.top;
                nebula.style.opacity = '0.2'; // More subtle nebulae
                starfield.appendChild(nebula);
            });
        }

        function showWelcomeQuestion() {
            document.getElementById('scrollEntrance').classList.add('hidden');
            document.getElementById('welcomeQuestion').classList.remove('hidden');
        }

        function showRealm(realmId) {
            document.getElementById('entranceSection').classList.add('hidden');
             document.querySelectorAll('.realm.active').forEach(realm => realm.classList.remove('active'));
            const realmToShow = document.getElementById(realmId + 'Realm');
            if (realmToShow) {
                realmToShow.classList.add('active');
            }
            if (realmId === 'guidance') {
                createConstellation();
            }
            if (realmId === 'fortune') {
                initScratchCard();
            }
        }

        function returnToWelcome() {
            document.querySelectorAll('.realm.active').forEach(realm => realm.classList.remove('active'));
            document.getElementById('entranceSection').classList.remove('hidden');
            document.getElementById('welcomeQuestion').classList.remove('hidden');
            document.getElementById('scrollEntrance').classList.add('hidden');
        }

        function revealBlessing(icon, title, message) {
            document.getElementById('modalIcon').textContent = icon;
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalMessage').innerHTML = message;
            document.getElementById('blessingModal').classList.add('active');
        }

        function revealDynamicBlessing(category, icon, title) {
            const mainContentArray = personalizedContent[category];
            let message = mainContentArray[Math.floor(Math.random() * mainContentArray.length)];

            // If it's an apology, add a random promise.
            if (category === 'apology') {
                const promiseArray = personalizedContent['promise'];
                const randomPromise = promiseArray[Math.floor(Math.random() * promiseArray.length)];
                message += `<span class="promise"><strong>Promise of Compensation:</strong><br>${randomPromise}</span>`;
            }

            revealBlessing(icon, title, message);
        }

        function readBook(type, title, content) {
            document.getElementById('bookTitle').textContent = title;
            document.getElementById('bookContent').textContent = content;
            document.getElementById('bookModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        const wisdoms = [
            "The cosmos whispers: Every storm passes, every wound heals. You are loved beyond the capacity of words to express.",
            "Ancient prophecy reveals: The strongest bonds are forged in the fires of challenge, tempered by time, unbreakable.",
            "The stars align to say: Your happiness is the universe's greatest priority, written in celestial law.",
            "Celestial wisdom speaks: In every ending lies a new beginning, in every tear, the seed of future joy.",
            "The void echoes: You are cherished, valued, and irreplaceable in this cosmic dance of existence.",
            "Oracle of ages declares: Bad days fade like morning mist before the eternal sun of unconditional love."
        ];

        function revealWisdom() {
            const wisdom = wisdoms[Math.floor(Math.random() * wisdoms.length)];
            const oracleText = document.getElementById('oracleText');
            oracleText.style.opacity = '0';
            setTimeout(() => {
                oracleText.textContent = wisdom;
                oracleText.style.transition = 'opacity 1s';
                oracleText.style.opacity = '1';
            }, 500);
        }

        let constellationCreated = false;
        function createConstellation() {
            const canvas = document.getElementById('constellationCanvas');
            // Allow re-creation for better viewing on guide page
            // if (!canvas || constellationCreated) return; 
            // constellationCreated = true;
            canvas.innerHTML = '';
            
            const memories = [
                { text: "The First Smile", x: 15, y: 20 }, { text: "First Laugh Together", x: 35, y: 15 },
                { text: "That Perfect Day", x: 55, y: 25 }, { text: "When I Knew", x: 70, y: 20 },
                { text: "Your Favorite Moment", x: 85, y: 30 }, { text: "Our Inside Joke", x: 25, y: 50 },
                { text: "The Comfort We Share", x: 45, y: 55 }, { text: "Dancing in the Kitchen", x: 65, y: 60 },
                { text: "Late Night Talks", x: 80, y: 55 }, { text: "Future Adventures", x: 20, y: 80 },
                { text: "Forever Promise", x: 50, y: 85 }, { text: "Every Day After", x: 75, y: 75 }
            ];
            
            memories.forEach((memory, index) => {
                const point = document.createElement('div');
                point.className = 'astral-point';
                point.style.left = memory.x + '%';
                point.style.top = memory.y + '%';
                point.title = memory.text;
                canvas.appendChild(point);
            });
            
            for (let i = 0; i < memories.length - 1; i++) {
                const line = document.createElement('div');
                line.className = 'astral-line';
                const p1 = memories[i];
                // Connect points in a slightly more interesting way
                const p2 = (i % 4 === 3) ? memories[i - 2] : memories[i + 1];
                const canvasWidth = canvas.offsetWidth;
                const canvasHeight = canvas.offsetHeight;
                
                // Only calculate and draw lines if canvas has dimensions
                if (canvasWidth > 0 && canvasHeight > 0) {
                    const p1x = p1.x / 100 * canvasWidth;
                    const p1y = p1.y / 100 * canvasHeight;
                    const p2x = p2.x / 100 * canvasWidth;
                    const p2y = p2.y / 100 * canvasHeight;
                    
                    const length = Math.sqrt(Math.pow(p2x - p1x, 2) + Math.pow(p2y - p1y, 2));
                    const angle = Math.atan2(p2y - p1y, p2x - p1x) * 180 / Math.PI;
                    
                    line.style.width = length + 'px';
                    line.style.left = p1.x + '%';
                    line.style.top = p1.y + '%';
                    line.style.transform = `rotate(${angle}deg)`;
                    canvas.appendChild(line);
                }
            }
        }
        
        let litCandles = 0;
        const totalCandles = 7;
        function lightCandle(candle) {
            if (!candle.classList.contains('lit')) {
                candle.classList.add('lit');
                litCandles++;
                if (litCandles === totalCandles) {
                    document.getElementById('ritualComplete').style.display = 'block';
                    setTimeout(() => {
                        revealBlessing('◈', 'The Ritual is Complete', 'Ancient forces smile upon you. Harmony has been restored. All is forgiven, all is renewed, all is well.');
                        // Reset candles after the ritual is complete and acknowledged
                        setTimeout(resetCandles, 2000);
                    }, 1500);
                }
            }
        }

        function resetCandles() {
             document.querySelectorAll('.candle.lit').forEach(c => c.classList.remove('lit'));
             document.getElementById('ritualComplete').style.display = 'none';
             litCandles = 0;
        }

        // --- SCRATCH CARD LOGIC ---
        const winPrizes = [
            { title: "Cosmic Coupon: Weekend Getaway!", description: "Claim a weekend away to a destination of your choice." },
            { title: "Cosmic Coupon: No Dishes For a Week!", description: "You are exempt from all dish-related duties for 7 days." },
            { title: "Cosmic Coupon: Sunset Dinner!", description: "A romantic dinner and drinks at a beautiful scenic spot." },
            { title: "Cosmic Coupon: Breakfast in Bed!", description: "A delicious, royal breakfast served to you in bed." },
            { title: "Cosmic Coupon: Relaxing Massage!", description: "A full, professional-tier massage with luxurious oils." },
            { title: "Cosmic Coupon: Movie Marathon!", description: "Your choice of movie or show, with all your favorite snacks." },
            { title: "Cosmic Coupon: A Giant Cuddle!", description: "Redeemable for one enormous, soul-recharging cuddle, anytime." },
            { title: "Cosmic Coupon: Customized!", description: "This coupon can be whatever you want it to be. Your wish is my command!" }
        ];
        const losePrize = { title: "A Whisper from the Void...", description: "The stars weren't aligned this time. But my love for you is constant! Try again." };

        const scratchCanvas = document.getElementById('scratchCanvas');
        const prizeTitleEl = document.getElementById('prizeTitle');
        const prizeDescriptionEl = document.getElementById('prizeDescription');
        let ctx;

        function initScratchCard() {
            // Determine win/loss based on Zoya's suggestion (1 in 10, so 10% chance)
            const isWin = Math.random() < 0.1; 
            const prize = isWin 
                ? winPrizes[Math.floor(Math.random() * winPrizes.length)] 
                : losePrize;

            prizeTitleEl.textContent = prize.title;
            prizeDescriptionEl.textContent = prize.description;

            setupCanvas();
        }

        function setupCanvas() {
            if (!scratchCanvas) return;
            ctx = scratchCanvas.getContext('2d');
            scratchCanvas.width = scratchCanvas.parentElement.offsetWidth;
            scratchCanvas.height = scratchCanvas.parentElement.offsetHeight;

            // Draw the scratchable layer
            const gradient = ctx.createLinearGradient(0, 0, scratchCanvas.width, scratchCanvas.height);
            gradient.addColorStop(0, '#d4af37');
            gradient.addColorStop(1, '#ffd700');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, scratchCanvas.width, scratchCanvas.height);
            
            // Add some text on top
            ctx.fillStyle = '#4a2c0f';
            ctx.font = 'bold 30px Cinzel';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('Scratch to Reveal Your Prize', scratchCanvas.width / 2, scratchCanvas.height / 2);
            ctx.font = '20px Cinzel';
            ctx.fillText('✧', scratchCanvas.width / 2, scratchCanvas.height / 2 + 40);

            // Setup event listeners
            let isDrawing = false;
            scratchCanvas.addEventListener('mousedown', (e) => isDrawing = true);
            scratchCanvas.addEventListener('mouseup', (e) => isDrawing = false);
            scratchCanvas.addEventListener('mousemove', (e) => {
                if (!isDrawing) return;
                const rect = scratchCanvas.getBoundingClientRect();
                scratch(e.clientX - rect.left, e.clientY - rect.top);
            });
            // Touch events
            scratchCanvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                isDrawing = true;
            }, { passive: false });
            scratchCanvas.addEventListener('touchend', (e) => {
                e.preventDefault();
                isDrawing = false;
            }, { passive: false });
            scratchCanvas.addEventListener('touchmove', (e) => {
                e.preventDefault();
                if (!isDrawing) return;
                const rect = scratchCanvas.getBoundingClientRect();
                const touch = e.touches[0];
                scratch(touch.clientX - rect.left, touch.clientY - rect.top);
            }, { passive: false });
        }

        function scratch(x, y) {
            if (!ctx) return;
            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath();
            ctx.arc(x, y, 25, 0, Math.PI * 2, true);
            ctx.fill();
        }
        
        document.addEventListener('DOMContentLoaded', createStarfield);
    </script>
    <script>
        const scrollToTopBtn = document.getElementById('scroll-to-top');
        if (scrollToTopBtn) {
            window.addEventListener('scroll', () => {
                if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
                    scrollToTopBtn.style.display = 'block';
                } else {
                    scrollToTopBtn.style.display = 'none';
                }
            });
            scrollToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        // Listen for theme changes from parent
window.addEventListener('message', (event) => {
  if (event.data.type === 'THEME_CHANGED') {
    const themeName = event.data.theme;
    applyThemeToOracle(themeName);
  }
});

function applyThemeToOracle(themeName) {
  // Apply the same theme system here
  const themeStars = {
    mystical: { char: '✦', color: '#ffd700' },
    ethereal: { char: '💧', color: '#64ffda' },
    sunset: { char: '🔥', color: '#ff9f43' },
    forest: { char: '🍃', color: '#2ecc71' },
    midnight: { char: '✨', color: '#e0e0e0' },
    coral: { char: '🪸', color: '#ff7b54' },
    royal: { char: '💎', color: '#c4af9f' },
    ocean: { char: '🌊', color: '#00d9ff' }
  };
  
  const starShape = themeStars[themeName];
  if (!starShape) return;
  
  // Update existing stars
  const stars = document.querySelectorAll('.star');
  stars.forEach(star => {
    star.textContent = starShape.char;
    star.style.color = starShape.color;
  });
  
  const shootingStars = document.querySelectorAll('.shooting-star');
  shootingStars.forEach(star => {
    star.textContent = starShape.char;
    star.style.color = starShape.color;
  });
}
    </script>
</body>
</html>